# Join patients and staff based on their common service field (show patient and staff who work in same service).

select p.patient_id,p.name,p.service,s.staff_name
from patients as p
inner join staff as s
on p.service = s.service;

# Join services_weekly with staff to show weekly service data with staff information.

select s.staff_id,s.staff_name,s.role,s.service,sw.week
from staff as s
inner join services_weekly as sw
on s.service = sw.service;

# Create a report showing patient information along with staff assigned to their service.

select p.patient_id,p.name,p.service,s.staff_id,s.staff_name,s.role
from patients as p
inner join staff as s
on p.service = s.service;


# Create a comprehensive report showing patient_id, patient name, age, service, and the total number of staff members available in their service. Only include patients from services that have more than 5 staff members. Order by number of staff descending, then by patient name.

select p.patient_id,p.name,p.age,p.service,count(s.staff_id) as total_staff
from patients as p
inner join staff as s
on p.service = s.service
group by p.patient_id,p.name,p.age,p.service
having count(s.staff_id)>5
order by total_staff desc,p.name;
